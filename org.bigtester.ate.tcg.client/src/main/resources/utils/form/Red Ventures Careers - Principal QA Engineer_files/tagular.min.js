/*! tagular.js-v3.2.112-2015-07-01 */
!function(){function require(a){var b=require.modules[a];if(!b)throw new Error('failed to require "'+a+'"');return"exports"in b||"function"!=typeof b.definition||(b.client=b.component=!0,b.definition.call(this,b.exports={},b),delete b.definition),b.exports}require.loader="component",require.helper={},require.helper.semVerSort=function(a,b){for(var c=a.version.split("."),d=b.version.split("."),e=0;e<c.length;++e){var f=parseInt(c[e],10),g=parseInt(d[e],10);if(f!==g)return f>g?1:-1;var h=c[e].substr((""+f).length),i=d[e].substr((""+g).length);if(""===h&&""!==i)return 1;if(""!==h&&""===i)return-1;if(""!==h&&""!==i)return h>i?1:-1}return 0},require.latest=function(a,b){function c(a){throw new Error('failed to find latest module of "'+a+'"')}var d=/(.*)~(.*)@v?(\d+\.\d+\.\d+[^\/]*)$/,e=/(.*)~(.*)/;e.test(a)||c(a);for(var f=Object.keys(require.modules),g=[],h=[],i=0;i<f.length;i++){var j=f[i];if(new RegExp(a+"@").test(j)){var k=j.substr(a.length+1),l=d.exec(j);null!=l?g.push({version:k,name:j}):h.push({version:k,name:j})}}if(0===g.concat(h).length&&c(a),g.length>0){var m=g.sort(require.helper.semVerSort).pop().name;return b===!0?m:require(m)}var m=h.pop().name;return b===!0?m:require(m)},require.modules={},require.register=function(a,b){require.modules[a]={definition:b}},require.define=function(a,b){require.modules[a]={exports:b}},require.register("ddo~dlog@0.1.1",function(a,b){function c(a){return this instanceof c?(a=a?a:{},this.setName(a.name),this.setLevel(a.level),void this.setSize(a.size)):new c(a)}c.prototype.setName=function(a){return this.name=a?a:"DLOG",this.name},c.prototype.setLevel=function(a){return this.level=a&&this.level_map[a]?a:"info",this.level_no=this.level_map[this.level],this.level},c.prototype.setSize=function(a){return this.size=a?a:14,this.size},c.prototype.level_map={trace:1,debug:2,info:3,warn:4,error:5,silent:6},c.prototype.color_map={name:"cyan",trace:"black",debug:"green",info:"blue",warn:"orange",error:"red"},c.prototype.getCSS=function(a){return a?"font-size: "+this.size+"px;color: "+this.color_map[a]:"font-size: "+this.size+"px"},c.prototype.log=function(a,b){"silent"!==a&&this.level_map[a]>=this.level_no&&this.show(a,b)},c.prototype.isAllObj=function(a){for(var b=0;b<a.length;b++)if("object"!=typeof a[b])return!1;return!0},c.prototype.show=function(a,b){console.log("%c [%s] %c %s %c %s:",this.getCSS(),(new Date).toJSON(),this.getCSS("name"),this.name,this.getCSS(a),a.toUpperCase()),Array.isArray(b[0])&&this.isAllObj(b[0])&&console.table(b[0]),console[a].apply(console,b)},c.prototype.trace=function(){this.log("trace",arguments)},c.prototype.debug=function(){this.log("debug",arguments)},c.prototype.info=function(){this.log("info",arguments)},c.prototype.warn=function(){this.log("warn",arguments)},c.prototype.error=function(){this.log("error",arguments)},"undefined"!=typeof b&&b.exports&&(b.exports=c)}),require.register("component~trim@0.0.1",function(a,b){function c(a){return a.trim?a.trim():a.replace(/^\s*|\s*$/g,"")}a=b.exports=c,a.left=function(a){return a.trimLeft?a.trimLeft():a.replace(/^\s*/,"")},a.right=function(a){return a.trimRight?a.trimRight():a.replace(/\s*$/,"")}}),require.register("component~type@1.0.0",function(a,b){var c=Object.prototype.toString;b.exports=function(a){switch(c.call(a)){case"[object Function]":return"function";case"[object Date]":return"date";case"[object RegExp]":return"regexp";case"[object Arguments]":return"arguments";case"[object Array]":return"array";case"[object String]":return"string"}return null===a?"null":void 0===a?"undefined":a&&1===a.nodeType?"element":a===Object(a)?"object":typeof a}}),require.register("component~type@1.1.0",function(a,b){var c=Object.prototype.toString;b.exports=function(a){switch(c.call(a)){case"[object Date]":return"date";case"[object RegExp]":return"regexp";case"[object Arguments]":return"arguments";case"[object Array]":return"array";case"[object Error]":return"error"}return null===a?"null":void 0===a?"undefined":a!==a?"nan":a&&1===a.nodeType?"element":(a=a.valueOf?a.valueOf():Object.prototype.valueOf.apply(a),typeof a)}}),require.register("component~querystring@1.3.1",function(a){var b=encodeURIComponent,c=decodeURIComponent,d=require("component~trim@0.0.1"),e=require("component~type@1.1.0");a.parse=function(a){if("string"!=typeof a)return{};if(a=d(a),""==a)return{};"?"==a.charAt(0)&&(a=a.slice(1));for(var b={},e=a.split("&"),f=0;f<e.length;f++){var g,h=e[f].split("="),i=c(h[0]);(g=/(\w+)\[(\d+)\]/.exec(i))?(b[g[1]]=b[g[1]]||[],b[g[1]][g[2]]=c(h[1])):b[h[0]]=null==h[1]?"":c(h[1])}return b},a.stringify=function(a){if(!a)return"";var c=[];for(var d in a){var f=a[d];if("array"!=e(f))c.push(b(d)+"="+b(a[d]));else for(var g=0;g<f.length;++g)c.push(b(d+"["+g+"]")+"="+b(f[g]))}return c.join("&")}}),require.register("component~inherit@0.0.3",function(a,b){b.exports=function(a,b){var c=function(){};c.prototype=b.prototype,a.prototype=new c,a.prototype.constructor=a}}),require.register("redventures~pixel@master",function(a,b){b.exports=require("redventures~pixel@master/lib/index.js")}),require.register("redventures~pixel@master/lib/index.js",function(a,b){var c={host:window.location.hostname,path:"/pixel",protocol:window.location.protocol,cache:!1,cacheBust:"bust"},d={image:require("redventures~pixel@master/lib/pixels/image.js"),script:require("redventures~pixel@master/lib/pixels/script.js")};b.exports=a=function(a){var b=d[a];if(!b)throw new Error('invalid pixel "'+a+'"');return new b(c)},a.defaults=function(a){for(var b in a)c.hasOwnProperty(b)&&(c[b]=a[b])}}),require.register("redventures~pixel@master/lib/pixels/pixel.js",function(a,b){function c(a){a=a||{},this.params={},this.protocol=a.protocol,this.host=a.host,this.path=a.path,this.cache=!!a.cache,this.cacheBust=a.cacheBust}var d=require("component~querystring@1.3.1");b.exports=c,c.prototype.set=function(a,b){return this[a]=b,this},c.prototype.send=function(a,b){var c=arguments;if(1==c.length&&"object"==typeof a)for(var d in a)this.params[d]=a[d];else this.params[a]=b;return this},c.prototype.buildRequest=function(){var a=/^http/.test(this.host)?"":this.protocol;return!this.cache&&this.cacheBust&&(this.params[this.cacheBust]=(new Date).getTime()),""+a+this.host+this.path+"?"+d.stringify(this.params)}}),require.register("redventures~pixel@master/lib/pixels/image.js",function(a,b){function c(a){d.call(this,a)}var d=require("redventures~pixel@master/lib/pixels/pixel.js"),e=require("component~inherit@0.0.3");b.exports=c,e(c,d),c.prototype.end=function(a){var b=this,c=this.buildRequest(),d=new Image;return d.onload=function(){b.params={},a&&a()},d.src=c,this}}),require.register("redventures~pixel@master/lib/pixels/script.js",function(a,b){function c(a){d.call(this,a)}var d=require("redventures~pixel@master/lib/pixels/pixel.js"),e=require("component~inherit@0.0.3");b.exports=c,e(c,d),c.prototype.end=function(a){var b=this,c=this.buildRequest(),d=document.createElement("script"),e=document.getElementsByTagName("script")[0];return d.type="text/javascript",d.async=!0,d.src=c,d.onload=d.onreadystatechange=function(){var c=d.readyState;c&&"loaded"!=c&&"complete"!=c||(b.params={},a&&a())},e.parentNode.insertBefore(d,e),this}}),require.register("guille~ms.js@0.6.1",function(a,b){function c(a){var b=/^((?:\d+)?\.?\d+) *(ms|seconds?|s|minutes?|m|hours?|h|days?|d|years?|y)?$/i.exec(a);if(b){var c=parseFloat(b[1]),d=(b[2]||"ms").toLowerCase();switch(d){case"years":case"year":case"y":return c*k;case"days":case"day":case"d":return c*j;case"hours":case"hour":case"h":return c*i;case"minutes":case"minute":case"m":return c*h;case"seconds":case"second":case"s":return c*g;case"ms":return c}}}function d(a){return a>=j?Math.round(a/j)+"d":a>=i?Math.round(a/i)+"h":a>=h?Math.round(a/h)+"m":a>=g?Math.round(a/g)+"s":a+"ms"}function e(a){return f(a,j,"day")||f(a,i,"hour")||f(a,h,"minute")||f(a,g,"second")||a+" ms"}function f(a,b,c){return b>a?void 0:1.5*b>a?Math.floor(a/b)+" "+c:Math.ceil(a/b)+" "+c+"s"}var g=1e3,h=60*g,i=60*h,j=24*i,k=365.25*j;b.exports=function(a,b){return b=b||{},"string"==typeof a?c(a):b.long?e(a):d(a)}}),require.register("visionmedia~debug@2.1.0",function(a,b){function c(){return"WebkitAppearance"in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}function d(){var b=arguments,c=this.useColors;if(b[0]=(c?"%c":"")+this.namespace+(c?" %c":" ")+b[0]+(c?"%c ":" ")+"+"+a.humanize(this.diff),!c)return b;var d="color: "+this.color;b=[b[0],d,"color: inherit"].concat(Array.prototype.slice.call(b,1));var e=0,f=0;return b[0].replace(/%[a-z%]/g,function(a){"%%"!==a&&(e++,"%c"===a&&(f=e))}),b.splice(f,0,d),b}function e(){return"object"==typeof console&&"function"==typeof console.log&&Function.prototype.apply.call(console.log,console,arguments)}function f(a){try{null==a?localStorage.removeItem("debug"):localStorage.debug=a}catch(b){}}function g(){var a;try{a=localStorage.debug}catch(b){}return a}a=b.exports=require("visionmedia~debug@2.1.0/debug.js"),a.log=e,a.formatArgs=d,a.save=f,a.load=g,a.useColors=c,a.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],a.formatters.j=function(a){return JSON.stringify(a)},a.enable(g())}),require.register("visionmedia~debug@2.1.0/debug.js",function(a,b){function c(){return a.colors[j++%a.colors.length]}function d(b){function d(){}function e(){var b=e,d=+new Date,f=d-(i||d);b.diff=f,b.prev=i,b.curr=d,i=d,null==b.useColors&&(b.useColors=a.useColors()),null==b.color&&b.useColors&&(b.color=c());var g=Array.prototype.slice.call(arguments);g[0]=a.coerce(g[0]),"string"!=typeof g[0]&&(g=["%o"].concat(g));var h=0;g[0]=g[0].replace(/%([a-z%])/g,function(c,d){if("%%"===c)return c;h++;var e=a.formatters[d];if("function"==typeof e){var f=g[h];c=e.call(b,f),g.splice(h,1),h--}return c}),"function"==typeof a.formatArgs&&(g=a.formatArgs.apply(b,g));var j=e.log||a.log||console.log.bind(console);j.apply(b,g)}d.enabled=!1,e.enabled=!0;var f=a.enabled(b)?e:d;return f.namespace=b,f}function e(b){a.save(b);for(var c=(b||"").split(/[\s,]+/),d=c.length,e=0;d>e;e++)c[e]&&(b=c[e].replace(/\*/g,".*?"),"-"===b[0]?a.skips.push(new RegExp("^"+b.substr(1)+"$")):a.names.push(new RegExp("^"+b+"$")))}function f(){a.enable("")}function g(b){var c,d;for(c=0,d=a.skips.length;d>c;c++)if(a.skips[c].test(b))return!1;for(c=0,d=a.names.length;d>c;c++)if(a.names[c].test(b))return!0;return!1}function h(a){return a instanceof Error?a.stack||a.message:a}a=b.exports=d,a.coerce=h,a.disable=f,a.enable=e,a.enabled=g,a.humanize=require("guille~ms.js@0.6.1"),a.names=[],a.skips=[],a.formatters={};var i,j=0}),require.register("component~cookie@1.1.1",function(a,b){function c(a,b,c){c=c||{};var d=g(a)+"="+g(b);null==b&&(c.maxage=-1),c.maxage&&(c.expires=new Date(+new Date+c.maxage)),c.path&&(d+="; path="+c.path),c.domain&&(d+="; domain="+c.domain),c.expires&&(d+="; expires="+c.expires.toUTCString()),c.secure&&(d+="; secure"),document.cookie=d}function d(){return f(document.cookie)}function e(a){return d()[a]}function f(a){var b,c={},d=a.split(/ *; */);if(""==d[0])return c;for(var e=0;e<d.length;++e)b=d[e].split("="),c[h(b[0])]=h(b[1]);return c}function g(a){try{return encodeURIComponent(a)}catch(b){i("error `encode(%o)` - %o",a,b)}}function h(a){try{return decodeURIComponent(a)}catch(b){i("error `decode(%o)` - %o",a,b)}}var i=require("visionmedia~debug@2.1.0")("cookie");b.exports=function(a,b,f){switch(arguments.length){case 3:case 2:return c(a,b,f);case 1:return e(a);default:return d()}}}),require.register("component~json-fallback@1.0.0",function(exports,module){!function(){"use strict";function f(a){return 10>a?"0"+a:a}function quote(a){return escapable.lastIndex=0,escapable.test(a)?'"'+a.replace(escapable,function(a){var b=meta[a];return"string"==typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function str(a,b){var c,d,e,f,g,h=gap,i=b[a];switch(i&&"object"==typeof i&&"function"==typeof i.toJSON&&(i=i.toJSON(a)),"function"==typeof rep&&(i=rep.call(b,a,i)),typeof i){case"string":return quote(i);case"number":return isFinite(i)?String(i):"null";case"boolean":case"null":return String(i);case"object":if(!i)return"null";if(gap+=indent,g=[],"[object Array]"===Object.prototype.toString.apply(i)){for(f=i.length,c=0;f>c;c+=1)g[c]=str(c,i)||"null";return e=0===g.length?"[]":gap?"[\n"+gap+g.join(",\n"+gap)+"\n"+h+"]":"["+g.join(",")+"]",gap=h,e}if(rep&&"object"==typeof rep)for(f=rep.length,c=0;f>c;c+=1)"string"==typeof rep[c]&&(d=rep[c],e=str(d,i),e&&g.push(quote(d)+(gap?": ":":")+e));else for(d in i)Object.prototype.hasOwnProperty.call(i,d)&&(e=str(d,i),e&&g.push(quote(d)+(gap?": ":":")+e));return e=0===g.length?"{}":gap?"{\n"+gap+g.join(",\n"+gap)+"\n"+h+"}":"{"+g.join(",")+"}",gap=h,e}}var JSON=module.exports={};"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var cx,escapable,gap,indent,meta,rep;"function"!=typeof JSON.stringify&&(escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},JSON.stringify=function(a,b,c){var d;if(gap="",indent="","number"==typeof c)for(d=0;c>d;d+=1)indent+=" ";else"string"==typeof c&&(indent=c);if(rep=b,b&&"function"!=typeof b&&("object"!=typeof b||"number"!=typeof b.length))throw new Error("JSON.stringify");return str("",{"":a})}),"function"!=typeof JSON.parse&&(cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,JSON.parse=function(text,reviver){function walk(a,b){var c,d,e=a[b];if(e&&"object"==typeof e)for(c in e)Object.prototype.hasOwnProperty.call(e,c)&&(d=walk(e,c),void 0!==d?e[c]=d:delete e[c]);return reviver.call(a,b,e)}var j;if(text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}()}),require.register("component~emitter@1.1.3",function(a,b){function c(a){return a?d(a):void 0}function d(a){for(var b in c.prototype)a[b]=c.prototype[b];return a}b.exports=c,c.prototype.on=c.prototype.addEventListener=function(a,b){return this._callbacks=this._callbacks||{},(this._callbacks[a]=this._callbacks[a]||[]).push(b),this},c.prototype.once=function(a,b){function c(){d.off(a,c),b.apply(this,arguments)}var d=this;return this._callbacks=this._callbacks||{},c.fn=b,this.on(a,c),this},c.prototype.off=c.prototype.removeListener=c.prototype.removeAllListeners=c.prototype.removeEventListener=function(a,b){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var c=this._callbacks[a];if(!c)return this;if(1==arguments.length)return delete this._callbacks[a],this;for(var d,e=0;e<c.length;e++)if(d=c[e],d===b||d.fn===b){c.splice(e,1);break}return this},c.prototype.emit=function(a){this._callbacks=this._callbacks||{};var b=[].slice.call(arguments,1),c=this._callbacks[a];if(c){c=c.slice(0);for(var d=0,e=c.length;e>d;++d)c[d].apply(this,b)}return this},c.prototype.listeners=function(a){return this._callbacks=this._callbacks||{},this._callbacks[a]||[]},c.prototype.hasListeners=function(a){return!!this.listeners(a).length}}),require.register("component~once@0.0.1",function(a,b){var c=0,d=function(){return this}();b.exports=function(a){function b(){if(this==d){if(b.called)return;return b.called=!0,a.apply(this,arguments)}var c="__called_"+e+"__";if(!this[c])return this[c]=!0,a.apply(this,arguments)}var e=c++;return b}}),require.register("component~bind@1.0.0",function(a,b){var c=[].slice;b.exports=function(a,b){if("string"==typeof b&&(b=a[b]),"function"!=typeof b)throw new Error("bind() requires a function");var d=c.call(arguments,2);return function(){return b.apply(a,d.concat(c.call(arguments)))}}}),require.register("ded~domready@v0.3.0",function(a,b){!function(a,c){"undefined"!=typeof b?b.exports=c():"function"==typeof define&&"object"==typeof define.amd?define(c):this[a]=c()}("domready",function(a){function b(a){for(n=1;a=d.shift();)a()}var c,d=[],e=!1,f=document,g=f.documentElement,h=g.doScroll,i="DOMContentLoaded",j="addEventListener",k="onreadystatechange",l="readyState",m=h?/^loaded|^c/:/^loaded|c/,n=m.test(f[l]);return f[j]&&f[j](i,c=function(){f.removeEventListener(i,c,e),b()},e),h&&f.attachEvent(k,c=function(){/^c/.test(f[l])&&(f.detachEvent(k,c),b())}),a=h?function(b){self!=top?n?b():d.push(b):function(){try{g.doScroll("left")}catch(c){return setTimeout(function(){a(b)},50)}b()}()}:function(a){n?a():d.push(a)}})}),require.register("component~url@0.2.0",function(a){function b(a){switch(a){case"http:":return 80;case"https:":return 443;default:return location.port}}a.parse=function(a){var c=document.createElement("a");return c.href=a,{href:c.href,host:c.host||location.host,port:"0"===c.port||""===c.port?b(c.protocol):c.port,hash:c.hash,hostname:c.hostname||location.hostname,pathname:"/"!=c.pathname.charAt(0)?"/"+c.pathname:c.pathname,protocol:c.protocol&&":"!=c.protocol?c.protocol:location.protocol,search:c.search,query:c.search.slice(1)}},a.isAbsolute=function(a){return 0==a.indexOf("//")||!!~a.indexOf("://")},a.isRelative=function(b){return!a.isAbsolute(b)},a.isCrossDomain=function(b){b=a.parse(b);var c=a.parse(window.location.href);return b.hostname!==c.hostname||b.port!==c.port||b.protocol!==c.protocol}}),require.register("segmentio~ware@0.3.0",function(a,b){function c(a){return this instanceof c?(this.fns=[],void(a&&this.use(a))):new c(a)}b.exports=c,c.prototype.use=function(a){if(a instanceof c)return this.use(a.fns);if(a instanceof Array){for(var b,d=0;b=a[d];d++)this.fns.push(b);return this}return this.fns.push(a),this},c.prototype.run=function(){function a(d){var g=b[c++];if(!g)return e&&e.apply(null,[d].concat(f));if(g.length<f.length+2&&d)return a(d);if(g.length==f.length+2&&!d)return a();var h=[].slice.call(f);d&&h.unshift(d),h.push(a),g.apply(null,h)}var b=this.fns,c=0,d=arguments[arguments.length-1],e="function"==typeof d?d:null,f=e?[].slice.call(arguments,0,arguments.length-1):[].slice.call(arguments);return setTimeout(a,0),this}}),require.register("component~props@1.1.2",function(a,b){function c(a){return a.replace(/\.\w+|\w+ *\(|"[^"]*"|'[^']*'|\/([^/]+)\//g,"").replace(g,"").match(/[$a-zA-Z_]\w*/g)||[]}function d(a,b,c){var d=/\.\w+|\w+ *\(|"[^"]*"|'[^']*'|\/([^/]+)\/|[a-zA-Z_]\w*/g;return a.replace(d,function(a){return"("==a[a.length-1]?c(a):~b.indexOf(a)?c(a):a})}function e(a){for(var b=[],c=0;c<a.length;c++)~b.indexOf(a[c])||b.push(a[c]);return b}function f(a){return function(b){return a+b}}var g=/\b(this|Array|Date|Object|Math|JSON)\b/g;b.exports=function(a,b){var g=e(c(a));return b&&"string"==typeof b&&(b=f(b)),b?d(a,g,b):g}}),require.register("component~to-function@2.0.5",function(a,b){function c(a){switch({}.toString.call(a)){case"[object Object]":return g(a);case"[object Function]":return a;case"[object String]":return f(a);case"[object RegExp]":return e(a);default:return d(a)}}function d(a){return function(b){return a===b}}function e(a){return function(b){return a.test(b)}}function f(a){return/^ *\W+/.test(a)?new Function("_","return _ "+a):new Function("_","return "+h(a))}function g(a){var b={};for(var e in a)b[e]="string"==typeof a[e]?d(a[e]):c(a[e]);return function(a){if("object"!=typeof a)return!1;for(var c in b){if(!(c in a))return!1;if(!b[c](a[c]))return!1}return!0}}function h(a){var b=j(a);if(!b.length)return"_."+a;var c,d,e;for(d=0;d<b.length;d++)e=b[d],c="_."+e,c="('function' == typeof "+c+" ? "+c+"() : "+c+")",a=i(e,a,c);return a}function i(a,b,c){return b.replace(new RegExp("(\\.)?"+a,"g"),function(a,b){return b?a:c})}var j;try{j=require("component~props@1.1.2")}catch(k){j=require("component~props@1.1.2")}b.exports=c}),require.register("component~map@0.0.1",function(a,b){var c=require("component~to-function@2.0.5");b.exports=function(a,b){var d=[];b=c(b);for(var e=0;e<a.length;++e)d.push(b(a[e],e));return d}}),require.register("component~object@0.0.3",function(a){var b=Object.prototype.hasOwnProperty;a.keys=Object.keys||function(a){var c=[];for(var d in a)b.call(a,d)&&c.push(d);return c},a.values=function(a){var c=[];for(var d in a)b.call(a,d)&&c.push(a[d]);return c},a.merge=function(a,c){for(var d in c)b.call(c,d)&&(a[d]=c[d]);return a},a.length=function(b){return a.keys(b).length},a.isEmpty=function(b){return 0==a.length(b)}}),require.register("component~each@0.2.5",function(a,b){function c(a,b,c){for(var d=0;d<a.length;++d)b.call(c,a.charAt(d),d)}function d(a,b,c){for(var d in a)i.call(a,d)&&b.call(c,d,a[d])}function e(a,b,c){for(var d=0;d<a.length;++d)b.call(c,a[d],d)}try{var f=require("component~type@1.0.0")}catch(g){var f=require("component~type@1.0.0")}var h=require("component~to-function@2.0.5"),i=Object.prototype.hasOwnProperty;b.exports=function(a,b,g){switch(b=h(b),g=g||this,f(a)){case"array":return e(a,b,g);case"object":return"number"==typeof a.length?e(a,b,g):d(a,b,g);case"string":return c(a,b,g)}}}),require.register("./lib/request",function(a,b){function c(a){this.url=a,this.params={},this.timeout=1e3,this.id=++h,this.time=(new Date).getTime()}function d(a){var b=document.getElementsByTagName("script")[0];b?b.parentNode.insertBefore(a,b):(b=document.getElementsByTagName("head")[0],b.appendChild(a))}var e=require("component~querystring@1.3.1"),f=require("ded~domready@v0.3.0"),g=!!~navigator.userAgent.indexOf("MSIE");b.exports=a=c;var h=0;a.get=function(a){return new c(a)},c.prototype.query=function(a){for(var b in a)void 0!==a[b]&&null!==a[b]&&(this.params[b]=a[b]);return this},c.prototype.end=function(a){function b(b,d){return c(),b?a(b):d.error?a(new Error(d.error)):void a(null,d)}function c(){m&&clearTimeout(m);try{target.parentNode.removeChild(k),delete window[j]}catch(a){window[j]=void 0}}a=a||function(){};var h=e.stringify(this.params),i=this,j="tg_"+this.time+this.id;if(g&&h.length>=2e3)return this.params.framepost=!0,void f(function(){i.framepost(a)});window[j]=function(a){b(null,a)};var k=document.createElement("script"),l=~this.url.indexOf("http")?"":"//",m=null;l+=this.url,l+="?",l+=h,l+="&cb="+j,this.timeout&&(m=setTimeout(function(){c(),a(new Error("timeout"))},this.timeout)),k.src=l,k.type="text/javascript",k.async=!0,d(k)},c.prototype.framepost=function(a){var b=document.createElement("form"),c=null;try{c=document.createElement('<iframe name="tagular-frame">')}catch(d){c=document.createElement("iframe")}c.src="javascript:false",c.id="tagular-frame",c.name="tagular-frame",c.style.display="none",c.style.position="absolute",c.style.top="-2000px",c.style.left="0px",c.border=0,c.frameBorder=0,c.width=0,c.height=0,c.allowTransparency=!0,b.target="tagular-frame",b.action=this.url,b.method="POST",b.style.display="none",this.params.framepost=!0;for(var e in this.params)if(this.params.hasOwnProperty(e)){var f,g=this.params[e];try{f=document.createElement('<input name="'+e+'" />')}catch(d){f=document.createElement("input")}f.name=e,f.type="hidden",f.value=g,b.appendChild(f)}document.body.appendChild(c),document.body.appendChild(b),b.submit(),a(null)}}),require.register("./lib/uuid",function(a,b){b.exports=function c(a){return a?(a^16*Math.random()>>a/4).toString(16):([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,c)}}),require.register("./lib/hash",function(a,b){b.exports=function(a,b){var c,d,e,f,g,h,i,j;for(c=3&a.length,d=a.length-c,e=b,g=3432918353,h=461845907,j=0;d>j;)i=255&a.charCodeAt(j)|(255&a.charCodeAt(++j))<<8|(255&a.charCodeAt(++j))<<16|(255&a.charCodeAt(++j))<<24,++j,i=(65535&i)*g+(((i>>>16)*g&65535)<<16)&4294967295,i=i<<15|i>>>17,i=(65535&i)*h+(((i>>>16)*h&65535)<<16)&4294967295,e^=i,e=e<<13|e>>>19,f=5*(65535&e)+((5*(e>>>16)&65535)<<16)&4294967295,e=(65535&f)+27492+(((f>>>16)+58964&65535)<<16);switch(i=0,c){case 3:i^=(255&a.charCodeAt(j+2))<<16;case 2:i^=(255&a.charCodeAt(j+1))<<8;case 1:i^=255&a.charCodeAt(j),i=(65535&i)*g+(((i>>>16)*g&65535)<<16)&4294967295,i=i<<15|i>>>17,i=(65535&i)*h+(((i>>>16)*h&65535)<<16)&4294967295,e^=i}return e^=a.length,e^=e>>>16,e=2246822507*(65535&e)+((2246822507*(e>>>16)&65535)<<16)&4294967295,e^=e>>>13,e=3266489909*(65535&e)+((3266489909*(e>>>16)&65535)<<16)&4294967295,e^=e>>>16,e>>>0}}),require.register("./lib/context",function(a,b){function c(){this.settings={lifetime:30};var b=d(a.cid),c=d(a.sid),e=b?b.split("."):[];this.id=e[0],this.hash=e[1],this.expired=!!c}var d=require("component~cookie@1.1.1"),e=require("./lib/hash"),f=require("./lib/uuid"),g=require("component~url@0.2.0"),h=27;b.exports=a=c,a.cid="tgc",c.prototype.set=function(a,b){var c=this.settings;if(!c.hasOwnProperty(a))throw new Error('invalid setting "'+a+'"');c[a]=b},c.prototype.isNew=function(){return this.id?!1:!0},c.prototype.isNewVisit=function(){var a,b=g.parse(this.getReferrer()||""),c=this.hash;return b.hostname&&b.hostname.length&&b.hostname!=location.hostname&&(a=e(b.href,h),a!=c)?!0:!1},c.prototype.getReferrer=function(){return document.referrer},c.prototype.sync=function(){(this.isNew()||this.isNewVisit())&&(this.id=f()),(this.isNewVisit()||!this.hash)&&(this.hash=e(this.getReferrer()||"",h));var b=[this.id,this.hash].join(".");d(a.cid,b,{path:"/",maxage:60*this.settings.lifetime*1e3})},c.prototype.clear=function(){this.id=this.hash=0,d(a.cid,null,{path:"/"})}}),require.register("./lib/domify",function(a,b){function c(a,b){b=b||function(){};var c,f;switch(g(a)){case"string":f=a,a={escaped:!0};break;default:f=a.html}try{var h=document.createDocumentFragment(),i=h.appendChild(document.createElement("div"));i.innerHTML="X"+(a.escaped?unescape(f):f),c=function(){if(!i.firstChild)return b();var a=i.removeChild(i.firstChild);switch(a.nodeName.toLowerCase()){case"script":e(a,c);break;case"img":d(a,c);break;default:c()}}}catch(j){c()}return c()}function d(a,b){var c=new Image;c.src=a.src,b()}function e(a,b){var c=a.text||a.textContent||a.innerHTML,d=document.createElement("script");return a.src?(d.onload=d.onreadystatechange=function(){var a=d.readyState;a&&"complete"!=a&&"loaded"!=a||(d.onload=d.onreadystatechange=null,b())},d.src=a.src,f(d)):(h.test(c)&&(c=c.replace(h,"write($1)"),c="(function (write) {\n"+c+"\n}(tagular('write')));"),d.text=c,f(d),void setTimeout(b,10))}function f(a){if("array"===g(a))for(var b=0;b<a.length;b++)f(a[b]);else{var c=document.getElementsByTagName("script")[0];c.parentNode.insertBefore(a,c)}}var g=require("component~type@1.1.0"),h=/document\.write\((["']{0,1}.+['"]{0,1})\)/g;b.exports=c}),require.register("./lib/log",function(a,b){function c(){this.entries=[]}b.exports=new c,c.prototype.log=function(a,b){return this.entries.push({type:a,data:b}),this},c.prototype.logRequest=function(a,b,c){return this.log("request",{req:a,res:b,err:c||""}),this},c.prototype.getLog=function(){return this.entries}}),require.register("./lib/pluck",function(a,b){function c(a,b){return 2===arguments.length?d(a,b):function(b){return d(a,b)}}function d(a,b){return"array"!==f(b)?e(a,b):g(b,function(b){return e(a,b)})}function e(a,b){if(a&&b){for(var c,d=a.split(/[.\[\]]/),e=d.length,f=b,g=0;e>g&&(c=d[g],!c||(f=f[c],null!=f));g++);return f}}var f=require("component~type@1.1.0"),g=require("component~map@0.0.1");b.exports=c}),require.register("./lib/tags",function(a,b){function c(a){return this instanceof c?void(this.client=a):new c(a)}var d=require("component~type@1.1.0"),e=require("./lib/tags/util.js"),f=require("./lib/log"),g=require("redventures~pixel@master"),h=require("./lib/tags/plugins/index.js");b.exports=c,c.prototype.render=function(a,b,c,e){if(e=e||function(){},"array"!=d(a))return e();var g=this;if(!a||!a.length)return e();for(var h=0;h<a.length;h++)!function(a,d,i){g.renderOne(a,b,c,function(){f.log("firing",a),h>=i.length-1&&e()})}(a[h],h,a)},c.prototype.renderOne=function(a,b,c,d){var i=g("image").send(b);if("function"!=typeof d)return this;if(!h[a.plugin])return d(),this;try{h[a.plugin](a,c,this,function(b){return f.log("firing",a),b?d({err:b,tag:a}):(e.fired(a,i),void d())})}catch(j){d({err:j,tag:a})}return this}}),require.register("./lib/tags/util.js",function(a){var b=require("./lib/log");a.appendElements=function(b){for(var c=0;c<b.length;c++)switch(b[c].nodeName.toLowerCase()){case"script":a.appendScript(b[c])}},a.createScript=function(a){var b=document.createElement("script");return b.type="text/javascript",b.src=a,b},a.insertElement=function(b,c){document.body?document.body.appendChild(b):setTimeout(function(){a.insertElement(b,c)},10)},a.appendScript=function(b){var c=document.createElement("script");c.type="text/javascript",b.src&&b.src.length?(c.async=!0,c.src=b.src):c.text=b.text||b.textContent||b.innerHTML,a.insertElement(c)},a.fired=function(a,c){var d=a.config&&a.config.key_name,e=a.config&&a.config.key_value;d&&e&&(c.send("edt","pipe"),c.send("ed",[["key_name",d,"0"].join("|"),["key_value",e,"0"].join("|")].join(";"))),c.send("f",a.formulaId).send("r",a.reactionId).end(function(){b.log("fired",a)})}}),require.register("./lib/tags/plugins/index.js",function(a){a.html=require("./lib/tags/plugins/html.js"),a["mathtag-redir"]=require("./lib/tags/plugins/mathtag-redir.js"),a.mathtag=require("./lib/tags/plugins/mathtag.js"),a.ua=require("./lib/tags/plugins/ua.js"),a.adwordsconversion=a.adwordsremarketing=require("./lib/tags/plugins/adwords.js")}),require.register("./lib/tags/plugins/mathtag.js",function(a,b){var c=require("component~querystring@1.3.1");b.exports=function(a,b,d,e){var f=a.config.src+"?"+c.stringify(a.config.params),g=util.createScript(f);util.insertElement(g),e()}}),require.register("./lib/tags/plugins/mathtag-redir.js",function(a,b){var c=require("component~querystring@1.3.1");b.exports=function(a,b,d,e){var f=new Image(1,1),g=a.config.params;f.src=a.config.src+"?"+c.stringify(g),e()}}),require.register("./lib/tags/plugins/html.js",function(a,b){var c=require("./lib/domify");b.exports=function(a,b,d,e){return a.config.data?c(a.config.data,e):e()}}),require.register("./lib/tags/plugins/ua.js",function(a,b){function c(a,b,c,d){var e=a.config;return e.trackingId?(window[j]("create",e.trackingId,"auto",{name:"tglr"}),window[j](function(){var a=window[j].getByName("tglr");c.client.alias("ga.ua-cid",[e.trackingId,a.get("clientId")].join("."))}),void d()):d(new Error("no tracking ID found!"))}function d(a,b,c,d){return h("pageview",a.config)?(window[j]("tglr.send","pageview"),void d()):d()}function e(a,b,c,d){if(!h("order",a.config))return d();if(!b[0])return console&&console.log("no data"),d();var e=b[0][1];window[j]("tglr.require","ec"),i(window[j],e),window[j]("tglr.ec:setAction","purchase",{id:e.transactionID,affiliation:a.config.affiliation||"",revenue:e.total.transactionTotal,tax:(+m("total.taxRate",e)||0)*(+m("total.basePrice",e)||0),shipping:e.total.shipping||""}),window[j]("tglr.send","event","tagular","order",a.config.affiliation||""),d()}function f(a,b,c,d){if(!h("cart",a.config))return d();if(!b[0])return d();var e=b[0][1];window[j]("tglr.require","ec",{affiliation:a.config.affiliation||""}),i(window[j],e),window[j]("tglr.ec:setAction","add"),window[j]("tglr.send","event","tagular","cart",a.config.affiliation||""),d()}function g(a,b,c,d){var e=["<script>","(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){","(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),","m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)","})(window,document,'script','//www.google-analytics.com/analytics.js','tglrUa');","</script>"];
return window.GoogleAnalyticsObject?(j=window.GoogleAnalyticsObject,void d()):k({html:e.join(""),escaped:!1},function(){setTimeout(function(){j=window.GoogleAnalyticsObject,d()},10)})}function h(a,b){return a&&b&&b.events&&b.events[a]}function i(a,b){var c,d,e=b.items;if(e&&e.length)for(c=e.length;c--;)d=e[c],a("tglr.ec:addProduct",{id:d.productInfo.productID,name:d.productInfo.productName,category:d.category,price:d.price.transactionTotal,quantity:d.quantity||"1"})}var j,k=require("./lib/domify"),l=require("segmentio~ware@0.3.0"),m=require("./lib/pluck"),n=l().use(g).use(c).use(d).use(e).use(f);b.exports=function(a,b,c,d){return n.run(a,b,c,d)}}),require.register("./lib/tags/plugins/adwords.js",function(a,b){function c(a,b,c,e){return a.config.params?void d(function(){var b=window.google_trackConversion;b&&b(a.config.params),e()}):e()}function d(a){var b=document.createElement("script");b.src="//www.googleadservices.com/pagead/conversion_async.js",b.charset="utf-8",b.type="text/javascript",b.onload=b.onreadystatechange=function(){var c=b.readyState;c&&"complete"!=c&&"loaded"!=c||(b.onload=b.onreadystatechange=null,a())};var c=document.getElementsByTagName("script")[0];c.parentNode.insertBefore(b,c)}b.exports=c}),require.define("./lib/tags/component.json",{name:"tags","private":!0,main:"index.js",dependencies:{"component/type":"*","component/querystring":"*","redventures/pixel":"*","segmentio/ware":"*"},locals:["hash","uuid","domify","log","pluck"],json:["component.json"],scripts:["index.js","util.js","plugins/index.js","plugins/mathtag.js","plugins/mathtag-redir.js","plugins/html.js","plugins/ua.js","plugins/adwords.js"]}),require.register("./lib/encode",function(a,b){function c(a){var b,c,f,g,h,i,j,k="",l=0;for(a=d(a);l<a.length;)b=a.charCodeAt(l++),c=a.charCodeAt(l++),f=a.charCodeAt(l++),g=b>>2,h=(3&b)<<4|c>>4,i=(15&c)<<2|f>>6,j=63&f,isNaN(c)?i=j=64:isNaN(f)&&(j=64),k=k+e.charAt(g)+e.charAt(h)+e.charAt(i)+e.charAt(j);return k}function d(a){a=a.replace(/\r\n/g,"\n");for(var b="",c=0;c<a.length;c++){var d=a.charCodeAt(c);128>d?b+=String.fromCharCode(d):d>127&&2048>d?(b+=String.fromCharCode(d>>6|192),b+=String.fromCharCode(63&d|128)):(b+=String.fromCharCode(d>>12|224),b+=String.fromCharCode(d>>6&63|128),b+=String.fromCharCode(63&d|128))}return b}var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";b.exports=function(a){return c(a).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}}),require.register("./lib/tuple",function(a,b){function c(a,b){this.set=[],this.size=a,this.max=b,this.filter}var d=require("component~type@1.1.0");b.exports=a=c,c.prototype.add=function(a){this.size<this.max&&this.set.push(a)},c.prototype.fromArgs=function(){var a,b=Array.prototype.slice.call(arguments),c=[];if(!b)return!1;for(var e=0;e<this.size;e++){if(a=b[e],"function"===d(this.filter)&&(a=this.filter(e,a)),!a&&0!==a)return!1;c.push(a)}return this.set.push(c),this},c.prototype.fromArray=function(a){this.fromArgs.apply(this,a||[])},c.prototype.fromArrays=function(a){for(var b=0,c=a.length;c>b;b++){var d=a[b];this.fromArray(d)}return this},c.prototype.fromObject=function(a){for(var b in a)a.hasOwnProperty(b)&&this.fromArray([b,a[b]]);return this},c.prototype.fromVargs=function(a){return"array"===d(a[0])?"array"!==d(a[0][0])?this.fromArray(a[0]):this.fromArrays(a[0]):"object"===d(a[0])?this.fromObject(a[0]):this.fromArgs.apply(this,a||[]),this}}),require.register("./lib/strutil",function(a,b){var c=require("component~type@1.1.0");b.exports.isEmpty=function(a){return!a||0===a.length},b.exports.stringify=function(a){switch(c(a)){case"object":case"function":case"regexp":case"arguments":case"array":case"error":case"null":case"undefined":case"nan":case"element":a="";break;case"date":a=a.getTime().toString();break;default:a+=""}return a}}),require.register("./lib/chromedebug",function(a,b){function c(a){this.label=a}var d=window.console;c.prototype.enabled=function(){if("undefined"!=typeof d&&window.location){var a=window.location.hash||"",b=new RegExp(this.label,"i");if(b.test(a))return!0}return!1},c.prototype.profile=function(a){return this.enabled()&&d.profile(a)},c.prototype.profileEnd=function(){return this.enabled()&&d.profileEnd()},c.prototype.time=function(a){return this.enabled()&&d.time(a)},c.prototype.timeEnd=function(a){return this.enabled()&&d.timeEnd(a)},c.prototype.timeStamp=function(a){return this.enabled()&&d.timeStamp(a)},b.exports=function(a){return a=a||"chromedebug",new c(a)}}),require.register("./lib/tgs",function(a,b){function c(a,b,d){return this instanceof c?(this.deviceId=a||null,this.timestamp=b||null,void(this.hmac=d||null)):new c(a,b,d)}function d(){try{return g(f(location.toString()).query)._tgs||""}catch(a){return""}}var e=require("component~cookie@1.1.1"),f=require("component~url@0.2.0").parse,g=require("component~querystring@1.3.1").parse;b.exports=a=c,a.cid="tgs",c.get=function(){var b;return b=d()||e(a.cid)||"",c.parse(b)},c.parse=function(a){return c.apply(null,a.split("."))},c.prototype.toString=function(){return[this.deviceId,this.timestamp,this.hmac].join(".")},c.prototype.isEmpty=function(){return!this.deviceId||!this.timestamp||!this.hmac},c.prototype.sync=function(){return e(a.cid,this.toString(),{path:"/",maxage:18e5}),this}}),require.register("./lib/device",function(a,b){function c(a){this.deviceId=a}var d=require("component~cookie@1.1.1"),e=require("component~type@1.1.0");b.exports=a=c,a.cid="tg1d",c.get=function(){return new c(d(a.cid))},c.prototype.sync=function(){return this.deviceId&&d(a.cid,this.toString(),{path:"/",maxage:315569e5}),this},c.prototype.isEmpty=function(){return"string"!==e(this.deviceId)||""===this.deviceId},c.prototype.toString=function(){return""+this.deviceId}}),require.register("./lib/events",function(a){function b(a,b){var d=c(a,"builtin",b),e=c(a,"extra",b);return d.set.push(["uri",window.location.href]),e.set.concat(d.set)}function c(a,b,c){var g="extra"===b?f:e,h=new i(3,50);return c=d(a,b,c),c instanceof i?h=c:(h.filter=g,h.fromVargs([c])),h}function d(a,b,c){var d,e;switch(a=g.stringify(a)){case"cart":d=require("./lib/events/cart.js");break;case"pageview":d=require("./lib/events/pageview.js");break;case"order":d=require("./lib/events/order.js");break;case"visit":d=require("./lib/events/visit.js");break;default:d=require("./lib/events/default.js")}switch(e=d[b],h(e)){case"function":return e(c);case"undefined":return c;default:return e}}function e(a,b){switch(a){case 0:case 1:return b;case 2:return~~b||0}}function f(a,b){var c=g.stringify(b);if(2===a){var d=~~b||0;return d>3?!1:g.stringify(d)}return g.isEmpty(c)?!1:(0===a&&(b=j+b),b)}var g=require("./lib/strutil"),h=require("component~type@1.1.0"),i=require("./lib/tuple");a.resolve=b;var j=a.storePrefix="custom."}),require.register("./lib/events/default.js",function(a){a.builtin=null,a.extra=function(a){return a}}),require.register("./lib/events/pageview.js",function(a){a.builtin=function(){return[["host",window.location.hostname],["path",window.location.pathname],["query",window.location.search],["referrer",document.referrer]]}}),require.register("./lib/events/visit.js",function(a,b){b.exports.builtin=function(){return[["referrer",document.referrer,"1"],["host",window.location.hostname,"1"],["query",window.location.search,"1"],["path",window.location.pathname],["type","online","1"]]},b.exports.extra=function(a){return a}}),require.register("./lib/events/order.js",function(a){var b=require("./lib/tuple");a.builtin=function(a){var c=new b(3,50);return c.add(["data",a,"0"]),c},a.extra=function(){return void 0}}),require.register("./lib/events/cart.js",function(a){var b=require("./lib/tuple");a.builtin=function(a){var c=new b(3,50);return c.add(["data",a,"0"]),c}}),require.register("./lib/ruler",function(a,b){b.exports=require("./lib/ruler/ruler.js")}),require.register("./lib/ruler/ruler.js",function(a,b){function c(a){return this instanceof c?(this.rules=[],void("array"===g(a)&&e(a,f(this,this.add)))):new c(a)}var d=require("./lib/ruler/rule.js"),e=require("component~each@0.2.5"),f=require("component~bind@1.0.0"),g=require("component~type@1.1.0");b.exports=a=c,a.Rule=d,c.prototype.test=function(a){var b,c,d=this.rules;for(b=0,c=d.length;c>b;b+=1)if(!d[b].test(a))return!1;return!0},c.prototype.and=function(a){var b=this.rules.concat(a.rules);return new c(b)},c.prototype.rule=function(a){var b=new d(a,this);return this.rules.push(b),b},c.prototype.add=function(a){var b;return a instanceof d?b=a:(b=new d(a.path),b[a.comparator](a.value)),this.rules.push(b),this}}),require.register("./lib/ruler/rule.js",function(a,b){function c(a,b){this.path=a,this.ruler=b,this.stack=[]}var d=require("./lib/pluck"),e=require("./lib/ruler/comparators.js"),f=require("component~object@0.0.3"),g=require("component~each@0.2.5");b.exports=c,c.prototype.test=function(a){if("undefined"==typeof a)return!1;var b,c,e=d(this.path,a),f=this.stack;for(b=0;c=f[b];b+=1)if(!c(e))return!1;return!0},c.prototype.rule=function(){var a=this.ruler;return a.rule.apply(a,arguments)},c.prototype.end=function(){return this.ruler},g(f.keys(e),function(a){c.prototype[a]=function(b){return this.stack.push(function(c){return e[a](c,b)}),this}})}),require.register("./lib/ruler/comparators.js",function(a){a.matches=function(a,b){return b="string"==typeof b?new RegExp(b):b,new RegExp(b).test(a)},a.regex=a.matches,a.contains=function(a,b){return!!~a.indexOf(b)},a.ncontains=function(a,b){return!~a.indexOf(b)},a.is=function(a,b){return a===b},a.not=function(a,b){return a!==b},a.eq=function(a,b){return a==b},a.neq=function(a,b){return a!=b},a.gt=function(a,b){return a>b},a.gte=function(a,b){return a>=b},a.lt=function(a,b){return b>a},a.lte=function(a,b){return b>=a},a.exists=function(a){return null!=a},a.nexists=function(a){return null==a}}),require.register("./lib/reaction-counts",function(a,b){function c(a,b){this.contextId=a,this.deviceId=b,this.counts={},this.parse()}var d=require("component~cookie@1.1.1");b.exports=a=c,a.cid="tgrc";var e=c.prototype;e.get=function(a,b,c){var d=this.counts,e=this.getLevelId(c);return d[a]&&d[a][b]&&d[a][b][(c||"")+":"+e]},e.set=function(a,b,c,d,e){var f=this.counts,g=c+":"+this.getLevelId(c);return f[a]=f[a]||{},f[a][b]=f[a][b]||{},f[a][b][g]={runNumber:d,lastRunTime:e},this},e.getLevelId=function(a){var b;switch(a){case"session":case"context":b=this.contextId;break;case"device":b=this.deviceId;break;default:b="unknown"}return b},e.parse=function(){for(var b,c=d(a.cid),e=(c||"").split("."),f=e.length;f--;)b=e[f],this.parseSingle(b);return this},e.parseSingle=function(a){var b=(a||"").split(":");if(4===b.length){var c,d=b[3].split(","),e=b[1],f=b[2],g=b[0];switch(g){case"d":c="device:"+this.deviceId;break;case"s":c="session:"+this.contextId}this.counts[e]=this.counts[e]||{},this.counts[e][f]=this.counts[e][f]||{},this.counts[e][f][c]={runNumber:d[0],lastRunTime:d[1]}}},e.sync=function(){var b,c,e,f,g,h=[];for(e in this.counts)for(f in this.counts[e])for(g in this.counts[e][f]){if(b=this.counts[e][f][g],0===g.indexOf("session"))c="s";else{if(0!==g.indexOf("device"))break;c="d"}h.push([c,e,f,b.runNumber+","+b.lastRunTime].join(":"))}d(a.cid,h.join("."),{path:"/"})}}),require.register("./lib/reactor",function(a,b){function c(a){return this instanceof c?(this.client=a,this.ready=!1,this.qu=[],this.formulas=null,this.startTime=null,this.deviceId=null,this.contextId=null,this.provider=null,void this.setup()):new c(a)}function d(){console&&console.log("done")}var e=require("component~type@1.1.0"),f=require("./lib/reactor/steps/index.js"),g=require("./lib/reaction-counts");b.exports=c,c.prototype.setup=function(){var a=this;this.startTime=this.client.settings.ts,this.timeOffset=this.startTime-(new Date).getTime(),this.formulas=this.client.settings.formulas,this.provider=this.client.settings.provider,this.client.getDevice(function(b){a.deviceId=b,a.client.getSession(function(b){a.contextId=b,a.ready=!0,a.callReady()})})},c.prototype.callReady=function(){var a=this.qu,b=a.length;for(this.qu=[];b--;)a[b]()},c.prototype.run=function(a,b,c){function h(){j.run(a,b,c)}c="function"===e(c)?c:d;var i,j=this;return this.formulas=this.client.settings.formulas,this.ready?(b="array"===e(b)?b:[],this.counts=new g(this.deviceId,this.contextId),i={event:a,eventData:[].concat(b,[["eventName",a]])},f.run(this,i,c)):(this.qu.push(h),this)}}),require.register("./lib/reactor/util.js",function(a){var b=/%%([a-zA-Z\.0-9_,]+)%%/g,c=require("component~object@0.0.3");a.interpolate=function d(a,e,f){var g,h,i,j,k=a;if(a&&"object"==typeof a)for(k={},h=c.keys(a),j=h.length;j--;)i=h[j],k[i]=d(a[i],e,f);else for(;g=b.exec(a);)(!f||f&&e[g[1]])&&(k=k.replace(g[0],e[g[1]]||""));return k}}),require.register("./lib/reactor/steps/index.js",function(a,b){var c=require("segmentio~ware@0.3.0"),d=require("./lib/reactor/steps/untuple.js"),e=require("./lib/reactor/steps/gauntlet.js"),f=require("./lib/reactor/steps/interpolate.js"),g=require("./lib/reactor/steps/mimic-server.js"),h=require("./lib/reactor/steps/fire.js");b.exports=c().use(d).use(e).use(f).use(g).use(h)}),require.register("./lib/reactor/steps/gauntlet.js",function(a,b){function c(a,b,c){if(!a.formulas)return c();var g,h,i=0,j=a.formulas||[];b.passed=[];var k=d(b.origEventData);for(g=0,h=j.length;h>g;g+=1)!function(b,c,d,e,g){setTimeout(function(){var h,j=b.rules;try{h=c(j).test(k)}catch(l){console&&console.error&&console.error("failed",l),h=!1}h&&(d.passed=d.passed.concat(f(b,a))),i+=1,i===e&&g()},0)}(j[g],e,b,j.length,c)}function d(a){for(var b,c,d,e,f={core:{}},g=a.length;g--;)if(c=a[g],e=c[0].split("."),e.length>1){for(d=f[e[0]]=f[e[0]]||{},b=1;b<e.length-1;)d=d[e[b]]=d[e[b]]||{},b+=1;d[e[e.length-1]]=c[1]}else f.core[c[0]]=c[1];return f}var e=require("./lib/ruler"),f=require("./lib/reactor/steps/pick.js");b.exports=c}),require.register("./lib/reactor/steps/pick.js",function(a,b){function c(a,b){var c,f,g,h,i=a.rg,j=[];for(c=0;f=i[c];c+=1)d(a,f,b)&&(g=f.reactions,h=e(g),h.restrictionLevel=f.restrictionLevel,j.push(h));return j}function d(a,b,c){var d,e,f,g=b.restrictionCount,h=b.restrictionTime,i="";if(!g&&!h)return!0;switch(b.restrictionLevel){case"provider":return d=c.providerId,!0}return i=b.restrictionLevel+":"+d,e=c.counts.get(a.id,b.id,b.restrictionLevel),!e||e&&!e.runNumber&&!e.lastRunTime?!0:g&&h&&(f=(new Date).getTime()+(c.timeOffset||0),h*=1e3,h&&f-e.lastRunTime<=h&&e.runNumber>=g)?!1:!0}function e(a){for(var b,c,d,e=a.length,g=0,h=[];e--;)for(b=a[e],c=+b.weight,g+=c,d=0;c>d;d+=1)h.push(e);return 100>g&&(h=h.concat(new Array(+(100-g)))),a[h[f(0,h.length-1)]]}function f(a,b){return~~(Math.random()*(b-a+1)+a)}b.exports=c}),require.register("./lib/reactor/steps/untuple.js",function(a,b){function c(a,b,c){var d,e,f={};if(!b||!b.eventData||b.eventData&&!b.eventData.length)return c();for(b.origEventData=b.eventData,d=b.eventData.length;d--;)e=b.eventData[d],e&&e[0]&&(f[e[0]]=e[1]);b.eventData=f,c()}b.exports=c}),require.register("./lib/reactor/steps/interpolate.js",function(a,b){function c(a,b,c){for(var e=b.passed,f=(e||[]).length;f--;)e[f]=d.interpolate(e[f],b.eventData);c()}var d=require("./lib/reactor/util.js");b.exports=c}),require.register("./lib/reactor/steps/mimic-server.js",function(a,b){function c(a,b,c){if(!b.passed||b.passed&&!b.passed.length)return c();for(var e,f=b.passed.length;f--;)e=b.passed[f],e.reactionId=[e.groupId,e.id,d()].join("."),e.config=e.pluginConfig;c()}var d=require("./lib/uuid");b.exports=c}),require.register("./lib/reactor/steps/fire.js",function(a,b){function c(a,b,c){function e(d){function j(b){var c=a.counts.get(k.formulaId,k.groupId,k.restrictionLevel);!b&&k.restrictionLevel&&a.counts.set(k.formulaId,k.groupId,k.restrictionLevel,(c&&c.runNumber||0)+1,(new Date).getTime()),e(d+1)}if(d>=h)return a.counts.sync(),c();var k=g[d];return k?void f.tags.renderOne(k,i,b.origEventData,j):e(d+1)}var f=a.client,g=b.passed||[],h=g.length,i={p:f.settings.provider,c:a.contextId,rq:d(),m:"fired",sd:f.sd};e(0)}var d=require("./lib/uuid");b.exports=c}),require.register("./lib/client",function(a,b){function c(){this.context=new r,this.buffering=!0,this.init=!1,this.queue=[],this.tgs=u.get(),this.device=v.get(),this.emitter=new w,this.tags=j(this),this.settings={provider:"",session:30,dmpOnly:!1,origin:location.protocol+"//collector.tagular.com",version:"v1",hashchange:!0,endpoints:{tags:"tags",pixel:"pixel",collect:"collect",fired:"fired",counts:"counts"},formulas:null,counts:null},this.log=new l({name:"Tagular",size:11,level:"silent"}),this.sd=n(),this.reactor=k(this),t.timeStamp("Tagular client loaded")}var d=require("./lib/request"),e=require("./lib/events"),f=require("./lib/encode"),g=require("./lib/domify"),h=require("component~type@1.1.0"),i=window.JSON||require("component~json-fallback@1.0.0"),j=require("./lib/tags"),k=require("./lib/reactor"),l=require("ddo~dlog@0.1.1"),m=require("./lib/log"),n=require("./lib/uuid"),o=require("redventures~pixel@master"),p=require("./lib/strutil"),q=require("./lib/tuple"),r=require("./lib/context"),s=require("./lib/client/operation.js"),t=require("./lib/chromedebug")("tagulardebug"),u=require("./lib/tgs"),v=require("./lib/device"),w=require("component~emitter@1.1.3"),x=require("./lib/client/domevent.js"),y=function(){},z="custom.",A="alias.";b.exports=c,c.prototype.provider=function(a){this.set("provider",a)},c.prototype.queueFirst=function(a){this.queue.unshift(a)},c.prototype.queueNext=function(a){this.queue.push(a)},c.prototype.set=function(a,b){var c=this.settings;switch(a){case"loglevel":this.log.setLevel(b);break;case"session":this.context.set("lifetime",~~b);break;default:c.hasOwnProperty(a)||this.log.warn("option ("+a+") is not a valid property"),c[a]=b}},c.prototype.config=function(a){for(var b in a)a.hasOwnProperty(b)&&this.set(b,a[b])},c.prototype.store=function(){var a=y,b=Array.prototype.slice.call(arguments),c=new q(3,50),d=this.log;return"function"===h(b[b.length-1])&&(a=b.pop()),c.filter=function(a,b){var c=p.stringify(b);if(2===a){var e=~~b||1;return e>3?(d.warn("Store level is invalid (must be 0, 1, 2, or 3"),!1):p.stringify(e)}return p.isEmpty(c)?(d.warn("Keys and values cannot be empty"),!1):(0===a&&(c=z+c),c)},c.fromVargs(b),c.set&&c.set.length?void this.send(new s({m:"track",en:"store",ed:c.set},this.settings.endpoints.tags,a)):(d.warn({message:"Invalid store parameters provided",args:b}),a(new Error("tagular - invalid store key/value/level provided")))},c.prototype.alias=function(){var a=y,b=Array.prototype.slice.call(arguments),c=new q(2,50),d=this.log;return"function"===h(b[b.length-1])&&(a=b.pop()),c.filter=function(a,b){var c=p.stringify(b);return p.isEmpty(c)?(d.warn("Keys and values cannot be empty"),!1):(0===a&&(c=A+c),c)},c.fromVargs(b),c.set&&c.set.length?void this.send(new s({m:"alias",ed:c.set},this.settings.endpoints.tags,a)):(d.warn({message:"Invalid alias parameters provided",args:b}),a(new Error("tagular - invalid alias key/value provided")))},c.prototype.track=function(a,b,c){var d,e,f="function"===h(c)?c:y;d=this.createEvent(a,b),e=d.ed,this.reactor.run(a,e,y),d?this.send(new s(d,this.settings.endpoints.tags,f)):f(new Error("Invalid payload.  See log."))},c.prototype.createEvent=function(a,b){var c,d=this.log;return a=p.stringify(a),p.isEmpty(a)?(d.warn("Event name cannot be empty"),!1):(c=e.resolve(a,b),{m:"track",en:a,ed:c})},c.prototype.pageview=function(a,b){return this.track("pageview",a,b)},c.prototype.trackStructuredEvent=function(a,b,c,d){var e="function"===h(d)?d:y,f=this.createStructuredEvent(a,b,c);f?this.send(new s(f,e)):e(new Error("Invalid payload.  See log."))},c.prototype.emptyQueue=function(){return this.queue.splice(0,this.queue.length)},c.prototype.send=function(a){var b,c=a.payload,e=this;return this.buffering?this.queueNext(a):(t.time("Tagular sending "+c.m+" "+c.en),c.ed&&"object"==typeof c.ed&&(c.ed=f(i.stringify(c.ed)),c.edt=a.dataType),c.p=this.settings.provider,c.c=this.context.id,this.device.isEmpty()?!this.tgs.isEmpty()&&this.device.isEmpty()?(c.tgs=this.tgs.toString(),c.sd=this.sd):c.sd=this.sd:c.sd=this.device.toString(),this.log.info(c),b=[this.settings.origin,this.settings.version,a.endpoint].join("/"),void d.get(b).query(c).end(function(d,f){if(t.timeEnd("Tagular sending "+c.m+" "+c.en),m.logRequest({url:b,params:c},f,d),d)return a.callback(d);try{var g={p:c.p,c:c.c,sd:c.sd,rq:f.requestId,m:"fired"};return c.tgs&&(g._tgs=c.tgs),t.timeStamp("Tagular confirming "+c.m+" "+c.en),e.tags.render(f.tags||[],g,a.payload,function(){if(f&&f.tgs)try{e.tgs=u.parse(f.tgs).sync()}catch(b){}return f&&f.deviceId&&(e.device=new v(f.deviceId).sync()),e.emitter.emit("response",f),a.callback(null,f)})}catch(h){}return a.callback(null,f)}))},c.prototype.load=function(a,b){function c(a){if(!g[a])return b();var e=g[a],f="function"===h(e.callback)?e.callback:y;d.send(new s(e.payload,e.endpoint,function(b,d){return f(b,d),c(a+1)}))}var d=this,e=this.context;if(o.defaults({host:this.settings.origin,path:"/"+[this.settings.version,this.settings.endpoints.fired].join("/"),cache:!1,cacheBust:"ts"}),"function"===h(a)?(b=a,a={}):b=b||y,!this.buffering)return b(new Error("tagular was already initialized"));if(this.hashChange(),e.isNew()||e.isNewVisit()){var f=this.createEvent("visit",a);this.queueFirst(new s(f,this.settings.endpoints.tags))}e.sync(),this.emitter.once("response",function(){d.init=!0,d.emitter.emit("ready")}),this.buffering=!1;var g=this.emptyQueue();c(0)},c.prototype.getDevice=function(a){a="function"===h(a)?a:y;var b;return b=this.device.isEmpty()?!this.tgs.isEmpty()&&this.device.isEmpty()?this.tgs.deviceId||this.sd:this.sd:this.device.toString(),a(b),this},c.prototype.getTgs=function(a){var b=this,c=!this.buffering&&this.init;return a="function"===h(a)?a:y,c&&this.tgs&&!this.tgs.isEmpty()?a(this.tgs.toString()):this.emitter.once("ready",function(){b.getTgs(a)}),this},c.prototype.getSession=function(a){(a="function"===h(a)?a:y)(this.context.id)},c.prototype.write=function(a){return function(b){return a="function"===h(a)?a:y,g({html:b,escaped:!1},a),this}},c.prototype.getLog=function(){return m.getLog()},c.prototype.hashChange=function(){function a(){c.track("hashchange")}var b=this.settings.hashchange,c=this;b&&"onhashchange"in window&&x.bind(window,"hashchange",a)}}),require.register("./lib/client/operation.js",function(a,b){function c(a,b,c){this.dataType="tuples",this.payload=a||{},this.endpoint=b||"",this.callback="function"===e(c)?c:d,this.callback=f(this.callback)}function d(){}var e=require("component~type@1.1.0"),f=require("component~once@0.0.1");b.exports=c}),require.register("./lib/client/domevent.js",function(a){var b=window.addEventListener?"addEventListener":"attachEvent",c=window.removeEventListener?"removeEventListener":"detachEvent",d="addEventListener"!==b?"on":"";a.bind=function(a,c,e,f){return a[b](d+c,e,f||!1),e},a.unbind=function(a,b,e,f){return a[c](d+b,e,f||!1),e}}),require.register("tagular",function(a,b){var c=require("./lib/client"),d=window.tagular||{},e=d.Q||[];if(!(document.hidden||document.webkitHidden||document.mozHidden||document.msHidden)){var f=new c;b.exports=a=function(a){var b,c=[].slice.call(arguments,1);return b=f[a]&&f[a].apply(f,c),b===f&&(b=void 0),b},a.noop=function(){},setTimeout(function(){for(var b=0;b<e.length;b++)a.apply(null,e[b])},0)}}),"object"==typeof exports?module.exports=require("tagular"):"function"==typeof define&&define.amd?define("tagular",[],function(){return require("tagular")}):(this||window).tagular=require("tagular")}();
//# sourceMappingURL=tagular.min.map
tagular('set', 'formulas', []);